---

# 1. 画面名

---

**シフト管理画面（管理者用）**

![image.png](image.png)

---

# 2. 要素別仕様

---

## 2-1. AdminHeader（ヘッダー・ナビゲーション）

![image.png](image%201.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O | 説明                                                                 |
|--------------------|------------------|-----|----------------------------------------------------------------------|
| シフト管理ボタン   | ボタン           | 入力 | シフト管理画面へ遷移（現在画面の場合はハイライト）                   |
| スタッフ管理ボタン | ボタン           | 入力 | スタッフ管理画面へ遷移                                               |
| 管理者アバター     | アバター         | 表示 | 管理者アイコン表示（32x32px）                                        |
| 管理者名表示       | テキスト         | 表示 | 「管理者」を表示                                                     |
| 通知アイコン       | アイコンボタン   | 入力 | 通知ドロワーを開く。未読件数バッジ表示あり                            |
| 履歴アイコン       | アイコンボタン   | 入力 | 変更依頼履歴ダイアログを表示                                         |
| 設定アイコン       | アイコンボタン   | 入力 | 設定メニューを表示                                                   |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| シフト管理遷移     | ボタン押下時   | シフト管理画面へ遷移                 | /tier-2dealer/admin/shifts | なし          |
| スタッフ管理遷移   | ボタン押下時   | スタッフ管理画面へ遷移               | /tier-2dealer/admin/staff  | なし          |
| 通知ドロワー表示   | アイコン押下時 | 通知ドロワーを開く                   | ドロワー表示         | なし          |
| 履歴表示           | アイコン押下時 | 変更依頼履歴ダイアログを表示         | ダイアログ表示       | なし          |
| 設定メニュー表示   | アイコン押下時 | 設定メニューを表示                   | メニュー表示         | なし          |

---

## 2-2. 設定メニュー

![image.png](image%202.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                           |
|----------------|------------------|-----|--------------------------------|
| エクセルエクスポート | メニューアイテム | 入力 | Excel出力ダイアログを表示      |
| ログアウト     | メニューアイテム | 入力 | ログアウト処理を実行           |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                 | 遷移先/動作         | バリデーション |
|--------------------|---------------|------------------------------|---------------------|---------------|
| Excel出力実行      | メニュー選択時 | Excel出力ダイアログを表示    | ダイアログ表示      | なし          |
| ログアウト実行     | メニュー選択時 | ログアウト処理を実行         | /tier-2dealer/admin/login | なし          |

---

## 2-3. 年月選択・提出状況・同期状態パネル

![image.png](image%203.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類      | I/O   | 説明                                                                 |
|--------------------|----------------------|-------|----------------------------------------------------------------------|
| 年月セレクタ       | YearMonthSelector    | 入力  | 表示対象の年月を選択                                                 |
| 提出済みチップ     | チップ               | 表示  | 提出済みスタッフ数を表示（クリックで詳細表示）                       |
| 未提出チップ       | チップ               | 表示  | 未提出スタッフ数を表示（クリックで詳細表示）                         |
| Ansteypeから同期ボタン | ボタン             | 入力  | Ansteypeからデータを同期                                             |
| Ansteypeへ提出ボタン | ボタン              | 入力  | シフト表をAnsteypeへ提出                                             |
| 同期ステータス表示 | ステータス表示       | 出力  | 同期状況・提出状況を表示                                             |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 年月変更           | セレクタ変更時 | 表示データの更新                     | なし                | なし          |
| 提出済み詳細表示   | チップクリック時 | 提出済みスタッフ一覧ダイアログ表示   | ダイアログ表示      | なし          |
| 未提出詳細表示     | チップクリック時 | 未提出スタッフ一覧ダイアログ表示     | ダイアログ表示      | なし          |
| 同期実行           | ボタン押下時   | Ansteypeとのデータ同期               | なし                | なし          |
| 提出実行           | ボタン押下時   | シフト表の提出処理                   | なし                | データ存在チェック |

---

## 2-4. SpreadsheetGrid（スプレッドシートグリッド）

![image.png](image%204.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 日付列             | 固定列           | 出力  | 日付・曜日を表示（sticky固定）                                       |
| アコーディオンボタン | トグルボタン    | 入力  | クローザー列の展開・折りたたみ                                      |
| C案件数列          | 入力セル         | 入出力| クローザー案件数の入力・表示                                         |
| G案件数列          | 入力セル         | 入出力| ガール案件数の入力・表示                                             |
| C可能列            | 計算セル         | 出力  | クローザー稼働可能人数の自動計算                                     |
| G可能列            | 計算セル         | 出力  | ガール稼働可能人数の自動計算                                         |
| 未決C列            | 計算セル         | 出力  | 未決クローザー案件数の自動計算                                       |
| 未決G列            | 計算セル         | 出力  | 未決ガール案件数の自動計算                                           |
| スタッフ列         | 複合セル         | 入出力| スタッフごとのステータス・稼働場所・単価                             |
| ステータスセル     | StatusCell       | 入力  | ○×-の希望ステータス選択                                             |
| 稼働場所セル       | LocationCell     | 入力  | 稼働場所の選択（○の場合のみ）。マウスオーバーで稼働場所の全文ツールチップ表示 |
| 単価セル           | RateCell         | 入力  | カスタム単価の入力                                                   |
| 要望セル           | RequestCell      | 入力  | スタッフの要望・コメント入力                                         |
| 固定情報行         | 固定行           | 出力  | 所属会社・氏名・カナ・最寄駅・単価・TEL・ID表示                      |
| 実績行             | 固定行           | 出力  | 各列の合計・実績値表示                                              |
| コメント行         | 折りたたみ行     | 入出力| スタッフ別コメント表示・編集                                         |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| アコーディオン切替 | ボタン押下時   | クローザー列の展開・折りたたみ      | なし                | なし          |
| 案件数入力         | 値変更時       | 案件数の更新・計算実行               | なし                | 数値のみ      |
| ステータス変更     | セル選択時     | ステータス更新・計算実行             | なし                | なし          |
| 稼働場所選択       | セル選択時     | 稼働場所の設定                       | なし                | ○の場合のみ  |
| 単価入力           | 値変更時       | カスタム単価の設定                   | なし                | 数値のみ      |
| 要望入力           | テキスト入力時 | 要望内容の保存                       | なし                | なし          |
| セル右クリック     | 右クリック時   | コンテキストメニュー表示             | なし                | なし          |
| 未決セルクリック   | クリック時     | 該当スタッフのフィルタ表示           | なし                | なし          |
| コメント追加・編集 | アイコン押下時 | 稼働場所セルのコメント追加・編集ダイアログ表示 | ダイアログ表示      | なし          |
| コメント表示       | アイコンマウスオーバー時 | コメント内容のツールチップ表示     | ツールチップ表示    | なし          |
| 稼働場所マウスオーバー | セルマウスオーバー時 | 稼働場所の全文をツールチップで表示 | ツールチップ表示    | なし          |

---

## 2-5. 変更依頼システム

![image.png](image%205.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 変更依頼ボタン     | ボタン           | 入力  | 提出後の変更依頼処理（提出済みの場合のみ表示）                       |
| 変更理由入力       | テキストフィールド| 入力  | 変更理由の入力                                                       |
| 変更内容解析       | 情報パネル       | 出力  | 変更された内容の詳細表示                                             |
| 提出確認ダイアログ | ダイアログ       | 入出力| 変更内容の確認と提出                                                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 変更依頼開始       | ボタン押下時   | 変更依頼フローの開始                 | なし                | 提出済みチェック |
| 変更理由入力       | テキスト入力時 | 変更理由の保存                       | なし                | なし          |
| 変更内容提出       | ダイアログ確認時| 変更依頼の作成・送信                 | なし                | 変更内容存在チェック |

---

## 2-6. 変更依頼履歴ダイアログ

![image.png](image%206.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 履歴一覧テーブル   | テーブル         | 出力  | 過去の変更依頼履歴を表示                                             |
| 依頼ID             | テーブルセル     | 出力  | 変更依頼の一意識別子                                                 |
| 対象スタッフ       | テーブルセル     | 出力  | 変更対象スタッフ名（複数の場合は省略表示、3名以上は「...」で省略）     |
| 対象月             | テーブルセル     | 出力  | 変更対象の年月                                                       |
| 依頼日時           | テーブルセル     | 出力  | 変更依頼の作成日時（日付・時刻を日本語形式で表示）                   |
| ステータスバッジ   | Chip             | 出力  | pending（承認待ち）/approved（承認済み）/rejected（却下）状態表示     |
| 変更件数           | テーブルセル     | 出力  | 変更項目の総数                                                       |
| 詳細表示ボタン     | ボタン           | 入力  | 変更内容の詳細を表示                                                 |
| 空データ表示       | テーブルセル     | 出力  | データがない場合は「変更依頼履歴がありません」を表示                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 詳細表示           | ボタン押下時   | 変更内容詳細ダイアログの表示         | ダイアログ表示      | なし          |
| 履歴更新           | 定期実行（5秒間隔） | 履歴データの再読み込み（LocalStorage） | なし              | なし          |
| ダイアログクローズ | 閉じるボタン押下時 | 履歴ダイアログを閉じる               | なし                | なし          |

---

## 2-7. 変更依頼詳細ダイアログ

![image.png](image%207.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 基本情報セクション | 情報表示         | 出力  | 依頼ID・対象月・スタッフ数・変更件数・依頼日時・変更理由・ステータス |
| ステータスバッジ   | Chip             | 出力  | 承認待ち・承認済み・却下の状態をカラー表示                           |
| 承認者コメント表示 | テキスト表示     | 出力  | 承認済み（approved）ステータスの場合のみ表示                         |
| スタッフ別変更内容 | テーブル         | 出力  | スタッフごとの詳細な変更内容                                         |
| 変更項目分類       | テーブルセル     | 出力  | シフト希望・要望テキスト・平日希望数・土日希望数に分類               |
| 項目ラベル変換     | テーブルセル     | 出力  | field値を日本語ラベルに変換（status→シフト希望等）                  |
| 日付表示           | テーブルセル     | 出力  | YYYY-MM-DD形式をYYYY年MM月DD日形式に変換表示                        |
| 変更前後比較       | テーブルセル     | 出力  | 変更前の値と変更後の値を比較表示（値がない場合は「-」表示）          |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログクローズ | 閉じるボタン押下時 | 詳細ダイアログを閉じる               | なし                | なし          |

---

## 2-8. 通知システム（NotificationSystem）

![image.png](image%2011.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 通知ドロワー       | Drawer           | 出力  | 画面右からスライドイン。通知一覧を表示                               |
| 通知バッジ         | バッジ           | 出力  | 未読件数を表示（AdminHeaderの通知アイコンに連動）                    |
| 通知リスト         | リスト           | 出力  | 通知内容（提出・承認・変更依頼等）を表示                             |
| 既読マーク         | ボタン           | 入力  | 通知を既読にする                                                     |
| 全削除ボタン       | ボタン           | 入力  | 通知を全て削除                                                       |
| 詳細ダイアログ     | ダイアログ       | 出力  | 通知の詳細内容を表示                                                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 通知ドロワー開閉   | 通知アイコン押下/ドロワークローズ | 通知一覧の表示・非表示 | Drawer表示/非表示   | なし          |
| 通知既読           | ボタン押下時   | 通知を既読にする                      | なし                | なし          |
| 通知全削除         | ボタン押下時   | 通知を全て削除                        | なし                | なし          |
| 通知詳細表示       | 通知クリック時 | 通知の詳細ダイアログを表示            | ダイアログ表示      | なし          |

---

## 2-9. Excel出力ダイアログ

![image.png](image%208.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 対象月選択         | マルチセレクト   | 入力  | エクスポート対象月の複数選択                                         |
| 選択月チップ表示   | チップ           | 出力  | 選択された月をチップで表示                                           |
| エクスポートボタン | ボタン           | 入力  | Excel形式でダウンロード実行                                         |
| プログレス表示     | ローディング     | 出力  | エクスポート中の進行状況表示                                         |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 対象月選択         | セレクト変更時 | エクスポート対象月の設定             | なし                | なし          |
| Excel出力実行      | ボタン押下時   | Excel形式でのファイル出力            | ダウンロード        | 対象月選択チェック |

---

## 2-10. バックアップ・復元機能

![image.png](image%209.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| バックアップ作成ボタン | ボタン         | 入力  | 現在のデータをLocalStorageにバックアップ                             |
| バックアップ復元ボタン | ボタン         | 入力  | バックアップからデータを復元                                         |
| バックアップクリアボタン | ボタン       | 入力  | バックアップデータを削除                                             |
| バックアップ情報表示 | 情報表示       | 出力  | バックアップの作成日時等を表示                                       |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| バックアップ作成   | ボタン押下時   | データのLocalStorageへの保存          | なし                | なし          |
| バックアップ復元   | ボタン押下時   | バックアップからの復元                | なし                | バックアップ存在チェック |
| バックアップ削除   | ボタン押下時   | バックアップデータの削除              | なし                | 確認ダイアログ |

---

## 2-11. 提出済みスタッフ詳細ダイアログ

![image.png](image%2010.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| スタッフ一覧       | リスト           | 出力  | 提出済み/未提出スタッフの一覧表示                                   |
| スタッフ情報カード | カード           | 出力  | スタッフ名・カナ・役割・提出状況を表示                               |
| 提出状況チップ     | チップ           | 出力  | submitted/draft状態をカラー表示                                      |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログクローズ | ボタン押下時   | スタッフ詳細ダイアログを閉じる        | なし                | なし          |

---

## 2-12. シフト提出ダイアログ

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| ダイアログタイトル | テキスト         | 出力  | ANSTEYPEへの全スタッフシフト提出確認                                 |
| 提出内容説明       | テキスト         | 出力  | 「20XX年X月の全スタッフのシフト希望をANSTEYPEに提出しますか？」      |
| 注意書き           | テキスト         | 出力  | 「※提出後はANSTEYPE管理者が承認するまで編集できません。」            |
| 対象スタッフ数     | テキスト         | 出力  | 「対象スタッフ数: XX名」                                             |
| 提出先             | テキスト         | 出力  | 「提出先: ANSTEYPE管理システム」                                     |
| キャンセルボタン   | ボタン           | 入力  | ダイアログを閉じる                                                   |
| 提出ボタン         | ボタン           | 入力  | 全スタッフシフトを提出する                                           |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログ表示     | 提出ボタン押下時| シフト提出確認ダイアログを表示       | ダイアログ表示      | なし          |
| キャンセル         | ボタン押下時   | ダイアログを閉じる                   | ダイアログ非表示    | なし          |
| シフト提出         | ボタン押下時   | 全スタッフシフトをANSTEYPEに提出     | 提出処理実行        | データ存在チェック |

---

# 3. その他仕様（要素に収まらない共通ルールや制約）

- **LocalStorage管理**: シフトデータ、スタッフ要望、バックアップデータの永続化
- **変更依頼履歴**: `tier2dealer_change_requests` キーでLocalStorageに保存
- **リアルタイム計算**: 案件数・稼働可能人数・未決数の自動計算
- **データ同期**: Ansteypeとの双方向データ同期（モック実装）
- **変更履歴管理**: 全ての変更をローカルストレージで履歴管理
- **固定表示**: 日付列・固定情報行・実績行はstickyで画面に固定
- **アコーディオン表示**: クローザー関連列の展開・折りたたみ機能
- **ドラッグ&ドロップ**: 未実装（将来的な拡張予定）
- **レスポンシブ対応**: lg/md/sm対応、画面幅に応じて列幅・フォントサイズを調整
- **セル種類**: StatusCell（○×-選択）、LocationCell（場所選択）、RateCell（単価入力）、RequestCell（要望入力）
- **カラー設計**: クローザー列（青系）、ガール列（ピンク系）、案件数列（青系）、稼働可能列（緑系）、未決列（黄系）、実績行（ピンク系）、土日（オレンジ系）、ヘッダー（グレー系）
- **複数月Excel出力**: 選択した複数月を別シートとして出力。セル結合・列構成・ファイル名・データ精度は実装通り
- **変更依頼フロー**: 提出済み→変更依頼→承認待ち→承認/却下の状態管理。差分自動検出・解析、履歴管理、通知システム連携。承認済み状態では承認者コメント表示
- **認証・セキュリティ**: LocalStorageベースの認証状態管理、未認証時の自動ログイン画面遷移、管理者権限でのみデータ編集可能
- **UI/UX**: Container maxWidth={false}で全幅対応、WCAG 2.2 AA準拠、ローディング・エラー表示、通知システム（リアルタイム通知）、キーボード操作対応
- **パフォーマンス**: useMemo、useCallbackでの最適化
- **技術仕様**: useState、useShiftStore（Zustand）、TypeScript、Material-UI、XLSX、file-saver、date-fns等 