---

# 1. 画面名

---

**シフト管理画面（管理者用）**

![image.png](image.png)

---

# 2. 要素別仕様

---

## 2-1. AdminHeader（ヘッダー・ナビゲーション）

![image.png](image%201.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O | 説明                                                                 |
|--------------------|------------------|-----|----------------------------------------------------------------------|
| シフト管理ボタン   | ボタン           | 入力 | シフト管理画面へ遷移（現在画面の場合はハイライト）                   |
| スタッフ管理ボタン | ボタン           | 入力 | スタッフ管理画面へ遷移                                               |
| 管理者アバター     | アバター         | 表示 | 管理者アイコン表示（32x32px）                                        |
| 管理者名表示       | テキスト         | 表示 | 「管理者」を表示                                                     |
| 通知アイコン       | アイコンボタン   | 入力 | 通知ドロワーを開く。未読件数バッジ表示あり                            |
| 履歴アイコン       | アイコンボタン   | 入力 | 変更依頼履歴ダイアログを表示                                         |
| 設定アイコン       | アイコンボタン   | 入力 | 設定メニューを表示                                                   |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| シフト管理遷移     | ボタン押下時   | シフト管理画面へ遷移                 | /tier-2dealer/admin/shifts | なし          |
| スタッフ管理遷移   | ボタン押下時   | スタッフ管理画面へ遷移               | /tier-2dealer/admin/staff  | なし          |
| 通知ドロワー表示   | アイコン押下時 | 通知ドロワーを開く                   | ドロワー表示         | なし          |
| 履歴表示           | アイコン押下時 | 変更依頼履歴ダイアログを表示         | ダイアログ表示       | なし          |
| 設定メニュー表示   | アイコン押下時 | 設定メニューを表示                   | メニュー表示         | なし          |

---

## 2-2. 設定メニュー

![image.png](image%202.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                           |
|----------------|------------------|-----|--------------------------------|
| エクセルエクスポート | メニューアイテム | 入力 | Excel出力ダイアログを表示      |
| ログアウト     | メニューアイテム | 入力 | ログアウト処理を実行           |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                 | 遷移先/動作         | バリデーション |
|--------------------|---------------|------------------------------|---------------------|---------------|
| Excel出力実行      | メニュー選択時 | Excel出力ダイアログを表示    | ダイアログ表示      | なし          |
| ログアウト実行     | メニュー選択時 | ログアウト処理を実行         | /tier-2dealer/admin/login | なし          |

---

## 2-3. 年月選択・提出状況・同期状態パネル

![image.png](image%203.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類      | I/O   | 説明                                                                 |
|--------------------|----------------------|-------|----------------------------------------------------------------------|
| 年月セレクタ       | YearMonthSelector    | 入力  | 表示対象の年月を選択                                                 |
| 提出済みチップ     | チップ               | 表示  | 提出済みスタッフ数を表示（クリックで詳細表示）                       |
| 未提出チップ       | チップ               | 表示  | 未提出スタッフ数を表示（クリックで詳細表示）                         |
| 一次店から同期ボタン | ボタン             | 入力  | 一次店からデータを同期                                               |
| 一次店へ提出ボタン | ボタン              | 入力  | シフト表を一次店へ提出                                               |
| 同期ステータス表示 | ステータス表示       | 出力  | 同期状況・提出状況を表示                                             |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 年月変更           | セレクタ変更時 | 表示データの更新                     | なし                | なし          |
| 提出済み詳細表示   | チップクリック時 | 提出済みスタッフ一覧ダイアログ表示   | ダイアログ表示      | なし          |
| 未提出詳細表示     | チップクリック時 | 未提出スタッフ一覧ダイアログ表示     | ダイアログ表示      | なし          |
| 同期実行           | ボタン押下時   | 一次店とのデータ同期                 | なし                | なし          |
| 提出実行           | ボタン押下時   | シフト表の提出処理                   | なし                | データ存在チェック |

---

## 2-4. SpreadsheetGrid（スプレッドシートグリッド）

![image.png](image%204.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 日付列             | 固定列           | 出力  | 日付・曜日を表示（sticky固定）                                       |
| アコーディオンボタン | トグルボタン    | 入力  | クローザー列の展開・折りたたみ                                      |
| C案件数列          | 入力セル         | 入出力| クローザー案件数の入力・表示                                         |
| G案件数列          | 入力セル         | 入出力| ガール案件数の入力・表示                                             |
| C可能列            | 計算セル         | 出力  | クローザー稼働可能人数の自動計算                                     |
| G可能列            | 計算セル         | 出力  | ガール稼働可能人数の自動計算                                         |
| 未決C列            | 計算セル         | 出力  | 未決クローザー案件数の自動計算                                       |
| 未決G列            | 計算セル         | 出力  | 未決ガール案件数の自動計算                                           |
| スタッフ列         | 複合セル         | 入出力| スタッフごとのステータス・稼働場所・単価                             |
| ステータスセル     | StatusCell       | 入力  | ○×-の希望ステータス選択                                             |
| 稼働場所セル       | LocationCell     | 入力  | 稼働場所の選択（○の場合のみ）。マウスオーバーで稼働場所の全文ツールチップ表示 |
| 単価セル           | RateCell         | 入力  | カスタム単価の入力                                                   |
| 要望セル           | RequestCell      | 入力  | スタッフの要望・コメント入力                                         |
| 固定情報行         | 固定行           | 出力  | 所属会社・氏名・カナ・最寄駅・単価・TEL・ID表示                      |
| 実績行             | 固定行           | 出力  | 各列の合計・実績値表示                                              |
| コメントセル       | CommentCell      | 入力  | 2次店専用コメント（常時編集可能・LocalStorage管理）                  |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| アコーディオン切替 | ボタン押下時   | クローザー列の展開・折りたたみ      | なし                | なし          |
| 案件数入力         | 値変更時       | 案件数の更新・計算実行               | なし                | 数値のみ      |
| ステータス変更     | セル選択時     | ステータス更新・計算実行             | なし                | なし          |
| 稼働場所選択       | セル選択時     | 稼働場所の設定                       | なし                | ○の場合のみ  |
| 単価入力           | 値変更時       | カスタム単価の設定                   | なし                | 数値のみ      |
| 要望入力           | テキスト入力時 | 要望内容の保存                       | なし                | なし          |
| コメント編集       | セルクリック時 | コメント編集モード開始・LocalStorage保存 | なし                | なし          |
| セル右クリック     | 右クリック時   | コンテキストメニュー表示             | なし                | なし          |
| 未決セルクリック   | クリック時     | 該当スタッフのフィルタ表示           | なし                | なし          |
| コメント追加・編集 | アイコン押下時 | 稼働場所セルのコメント追加・編集ダイアログ表示 | ダイアログ表示      | なし          |
| コメント表示       | アイコンマウスオーバー時 | コメント内容のツールチップ表示     | ツールチップ表示    | なし          |
| 稼働場所マウスオーバー | セルマウスオーバー時 | 稼働場所の全文をツールチップで表示 | ツールチップ表示    | 稼働場所存在チェック |

---

## 2-5. 稼働場所セル（LocationCell）マウスオーバー機能

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 稼働場所セル       | TableCell        | 表示  | スタッフの稼働場所を表示（幅112.5px固定）                            |
| 稼働場所テキスト   | テキスト         | 表示  | 稼働場所名（2行まで表示・省略表示対応）                              |
| マウスオーバーツールチップ | Tooltip    | 表示  | 稼働場所名の全文をツールチップで表示                                 |

### マウスオーバー機能仕様

#### 表示条件
- **稼働場所データ存在**: `location`データが存在する場合のみツールチップ表示
- **非表示条件**: 稼働場所が未設定（空文字・null・undefined）の場合はツールチップ非表示

#### 表示設定
- **表示遅延**: 300ms（`enterDelay={300}`）
- **次回表示遅延**: 300ms（`enterNextDelay={300}`）
- **配置**: 上部表示（`placement="top"`）
- **矢印**: 表示あり（`arrow`）
- **無効化**: 稼働場所データがない場合は`disableHoverListener={!location}`で無効化

#### セル表示仕様
- **セル幅**: 112.5px固定（`width: 112.5, maxWidth: 112.5`）
- **セル高**: 36px固定（`height: 36, minHeight: 36, maxHeight: 36`）
- **行数制限**: 最大2行表示（`WebkitLineClamp: 2`）
- **文字サイズ**: 12px（`fontSize: 12`）
- **折り返し**: 単語単位で折り返し（`wordBreak: 'break-word'`）
- **省略表示**: 2行を超える場合は省略記号で表示（`textOverflow: 'ellipsis'`）

#### ツールチップ表示内容
- **表示データ**: 稼働場所の全文（`title={location || ''}`）
- **改行対応**: 長い稼働場所名も全文表示
- **文字制限**: なし（全文表示）

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| マウスオーバー     | セルホバー開始時 | ツールチップ表示（300ms後）           | ツールチップ表示    | 稼働場所存在チェック |
| マウスアウト       | セルホバー終了時 | ツールチップ非表示                    | ツールチップ非表示  | なし          |
| セルクリック       | セル押下時     | 稼働場所選択・編集機能               | LocationCell機能   | 編集権限チェック |

### 表示文字数による動作

#### 短い稼働場所名（セル内に収まる場合）
- **例**: 「新宿」「渋谷」「池袋」
- **表示**: セル内に通常表示
- **ツールチップ**: 表示されるが内容は同じ

#### 長い稼働場所名（セル内に収まらない場合）
- **例**: 「東京都新宿区西新宿2-8-1 東京オペラシティタワー」
- **セル表示**: 「東京都新宿区西新宿2-8-1...」（2行で省略）
- **ツールチップ**: 「東京都新宿区西新宿2-8-1 東京オペラシティタワー」（全文表示）

#### 文字数基準
- **省略開始**: セル幅112.5px・フォントサイズ12px・2行制限により自動判定
- **概算文字数**: 日本語約15-20文字程度で省略表示開始
- **表示優先度**: システムによる自動判定（`WebkitLineClamp`使用）

---

## 2-6. シフトセル選択メニュー（StatusCell）

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| ステータスセル     | ButtonBase       | 入力  | ○×△の表示と選択操作                                                 |
| 選択メニュー       | Menu             | 入力  | セルクリック時に表示されるステータス選択メニュー                     |
| ○稼働メニュー項目 | MenuItem         | 入力  | 稼働希望を選択（白背景）                                             |
| ×休みメニュー項目 | MenuItem         | 入力  | 休み希望を選択（赤背景）                                             |
| △未定メニュー項目 | MenuItem         | 入力  | 未定状態を選択（薄黄色背景）                                         |
| 変更履歴ツールチップ | Tooltip        | 出力  | セルホバー時に変更履歴を表示（最新3件）                              |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| セルクリック       | セル押下時     | ステータス選択メニューを表示         | メニュー表示        | 読み取り専用チェック |
| ステータス選択     | メニュー項目選択時 | ステータス更新・メニュー閉じる     | 即座に反映          | 提出状態チェック |
| セルダブルクリック | ダブルクリック時 | ○セルのハイライト切り替え           | 視覚的強調          | ○かつ機能有効時のみ |
| 外部クリック       | メニュー外クリック時 | メニューを閉じる                   | メニュー非表示      | なし          |

---

## 2-6. コメントセル（CommentCell）常時編集機能

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| コメントセル       | CommentCell      | 入力  | スタッフ別コメント表示・編集セル（常時編集可能）                     |
| コメントテキスト   | Typography       | 表示  | コメント内容表示（クリックで編集モード）                             |
| 編集テキストフィールド | TextField    | 入力  | コメント編集用のマルチラインテキストフィールド                       |

### 編集機能仕様

#### 常時編集可能
- **編集権限**: 提出状態・編集モードに関係なく常時編集可能
- **独立性**: 他のシフトデータとは独立して管理（2次店専用データ）
- **データ管理**: LocalStorageで管理（連携対象外）

#### 編集操作
- **編集開始**: セルクリックで編集モード開始
- **編集確定**: 
  - Enter キー押下（Shift+Enterで改行）
  - フィールド外クリック（Blur）
- **編集キャンセル**: Escape キー押下
- **自動保存**: 編集確定時に即座にLocalStorageに保存

#### 表示仕様
- **セルサイズ**: colSpan={3}・可変高さ
- **フォントサイズ**: 0.75rem
- **カラー**: #9c27b0（紫系）
- **背景色**: #f3e5f5（薄紫）・hover時 #f0e0f5
- **プレースホルダー**: 「コメントを入力...」
- **未入力時表示**: 「（コメントなし）」

#### データ管理
- **保存形式**: `comments_${year}_${month}` キーでLocalStorage保存
- **データ構造**: `Record<staffId, comment>`
- **永続化**: ブラウザローカルでの永続化
- **同期対象外**: シフト提出・変更依頼・システム同期の対象外

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| コメント編集開始   | セルクリック時 | 編集モード開始・フォーカス設定       | 編集モード          | なし          |
| コメント保存       | Enter・Blur時  | LocalStorage保存・編集モード終了     | 表示モード          | なし          |
| コメント編集キャンセル | Escape時   | 変更内容破棄・編集モード終了         | 表示モード          | なし          |
| 改行入力           | Shift+Enter時  | 改行文字挿入（編集継続）             | なし                | なし          |

---

## 2-8. シフト変更操作ダイアログ

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| ダイアログタイトル | テキスト         | 出力  | 「シフト変更操作」                                                   |
| 説明文             | テキスト         | 出力  | 「シフト表の編集が可能になります。編集後「変更内容を提出」してください。キャンセルも可能です。」 |
| キャンセルボタン   | ボタン           | 入力  | 変更操作をキャンセルしてダイアログを閉じる                           |
| 操作開始ボタン     | ボタン           | 入力  | 編集モードを開始する                                                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログ表示     | シフト変更操作ボタン押下時| 変更操作確認ダイアログを表示       | ダイアログ表示      | 提出済みチェック |
| キャンセル         | ボタン押下時   | ダイアログを閉じる                   | ダイアログ非表示・通常モード | なし          |
| 操作開始           | ボタン押下時   | バックアップ作成・編集モード開始     | 編集可能状態・ダイアログ非表示 | なし          |

---

## 2-9. 変更内容提出確認ダイアログ

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| ダイアログタイトル | テキスト         | 出力  | 「変更内容の確認・提出」                                             |
| 説明文             | テキスト         | 出力  | 「以下の変更内容をANSTEYPE管理者に提出しますか？」                   |
| 注意書き1          | テキスト         | 出力  | 「※提出後は承認されるまで変更内容は実際のシフトに反映されません。」  |
| 基本情報パネル     | 情報パネル       | 出力  | 対象月・総変更件数を表示（グレー背景）                               |
| 対象月表示         | テキスト         | 出力  | 「対象月: YYYY年MM月」                                               |
| 総変更件数表示     | テキスト         | 出力  | 「総変更件数: XX件」                                                 |
| 変更内容詳細       | テーブル         | 出力  | スタッフ別の変更内容詳細                                             |
| スタッフ名見出し   | テキスト         | 出力  | 変更対象スタッフ名（太字）                                           |
| シフト希望変更     | テーブル         | 出力  | 日付・変更前・変更後の一覧（シフト希望の変更がある場合のみ表示）     |
| 要望変更           | テーブル         | 出力  | 項目・変更前・変更後の一覧（要望の変更がある場合のみ表示）           |
| 変更理由セクション | 入力セクション   | 入力  | 変更理由入力エリア                                                   |
| 変更理由見出し     | テキスト         | 出力  | 「変更理由」（太字）                                                 |
| 変更理由入力欄     | TextField        | 入力  | マルチライン（3行）・任意入力・プレースホルダー「変更理由を入力してください（任意）」 |
| 注意書き2          | テキスト         | 出力  | 「⚠️ 提出後は管理者の承認が必要です。内容をよく確認してから提出してください。」（赤色） |
| キャンセルボタン   | ボタン           | 入力  | 変更依頼をキャンセルしてダイアログを閉じる                           |
| 提出ボタン         | ボタン           | 入力  | 変更依頼を提出する（変更件数0の場合は無効化）                        |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログ表示     | 変更内容を提出ボタン押下時| 変更内容確認ダイアログを表示       | ダイアログ表示      | 変更内容存在チェック |
| 変更理由入力       | テキスト入力時 | 変更理由の保存                       | なし                | なし          |
| キャンセル         | ボタン押下時   | 編集モード継続・ダイアログ閉じる     | ダイアログ非表示    | なし          |
| 変更依頼提出       | ボタン押下時   | LocalStorage保存・通知送信・編集終了 | 通知システム連携・編集モード終了 | 変更内容存在チェック |

### 変更内容詳細の表示ルール

#### シフト希望変更テーブル
- **表示条件**: シフトステータス（○×△）の変更がある場合のみ
- **テーブル構成**: 
  - ヘッダー: 日付 | 変更前 | 変更後
  - データ: YYYY年MM月DD日形式 | 変更前ステータス | 変更後ステータス

#### 要望変更テーブル
- **表示条件**: 要望テキスト・平日希望数・土日希望数の変更がある場合のみ
- **テーブル構成**:
  - ヘッダー: 項目 | 変更前 | 変更後
  - データ項目: 要望テキスト | 平日希望数 | 土日希望数
  - 空値表示: 値がない場合は「（なし）」を表示

#### 変更なし表示
- **表示条件**: 変更内容が存在しない場合
- **表示内容**: 「変更内容がありません」（中央揃え・グレー文字）

---

## 2-10. 提出後変更依頼フロー全体

### フロー概要
1. **シフト変更操作ボタン押下** → シフト変更操作ダイアログ表示
2. **操作開始** → バックアップ作成・編集モード開始
3. **シフト表編集** → 通常通りセルクリックで編集
4. **変更内容を提出ボタン押下** → 変更内容提出確認ダイアログ表示
5. **変更内容を提出する** → LocalStorage保存・通知送信・編集モード終了

### 編集モード中のUI変更
- **シフト表**: 読み取り専用モードから編集可能モードに変更
- **ボタンエリア**: 「シフト変更操作」→「キャンセル」「変更内容を提出」に変更
- **バックアップ作成**: 編集開始時に元データをバックアップ
- **一時データ管理**: 編集中のデータは一時データとして管理

### キャンセル機能
- **キャンセルボタン**: 編集モード中に表示
- **動作**: バックアップからデータ復元・編集モード終了
- **影響**: 編集中の変更内容は全て破棄される

---

## 2-11. 変更依頼履歴ダイアログ

![image.png](image%206.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 履歴一覧テーブル   | テーブル         | 出力  | 過去の変更依頼履歴を表示                                             |
| 依頼ID             | テーブルセル     | 出力  | 変更依頼の一意識別子                                                 |
| 対象スタッフ       | テーブルセル     | 出力  | 変更対象スタッフ名（複数の場合は省略表示、3名以上は「...」で省略）     |
| 対象月             | テーブルセル     | 出力  | 変更対象の年月                                                       |
| 依頼日時           | テーブルセル     | 出力  | 変更依頼の作成日時（日付・時刻を日本語形式で表示）                   |
| ステータスバッジ   | Chip             | 出力  | pending（承認待ち）/approved（承認済み）/rejected（却下）状態表示     |
| 変更件数           | テーブルセル     | 出力  | 変更項目の総数                                                       |
| 詳細表示ボタン     | ボタン           | 入力  | 変更内容の詳細を表示                                                 |
| 空データ表示       | テーブルセル     | 出力  | データがない場合は「変更依頼履歴がありません」を表示                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 詳細表示           | ボタン押下時   | 変更内容詳細ダイアログの表示         | ダイアログ表示      | なし          |
| 履歴更新           | 定期実行（5秒間隔） | 履歴データの再読み込み（LocalStorage） | なし              | なし          |
| ダイアログクローズ | 閉じるボタン押下時 | 履歴ダイアログを閉じる               | なし                | なし          |

---

## 2-12. 変更依頼詳細ダイアログ

![image.png](image%207.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 基本情報セクション | 情報表示         | 出力  | 依頼ID・対象月・スタッフ数・変更件数・依頼日時・変更理由・ステータス |
| ステータスバッジ   | Chip             | 出力  | 承認待ち・承認済み・却下の状態をカラー表示                           |
| 承認者コメント表示 | テキスト表示     | 出力  | 承認済み（approved）ステータスの場合のみ表示                         |
| スタッフ別変更内容 | テーブル         | 出力  | スタッフごとの詳細な変更内容                                         |
| 変更項目分類       | テーブルセル     | 出力  | シフト希望・要望テキスト・平日希望数・土日希望数に分類               |
| 項目ラベル変換     | テーブルセル     | 出力  | field値を日本語ラベルに変換（status→シフト希望等）                  |
| 日付表示           | テーブルセル     | 出力  | YYYY-MM-DD形式をYYYY年MM月DD日形式に変換表示                        |
| 変更前後比較       | テーブルセル     | 出力  | 変更前の値と変更後の値を比較表示（値がない場合は「-」表示）          |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログクローズ | 閉じるボタン押下時 | 詳細ダイアログを閉じる               | なし                | なし          |

---

## 2-13. 通知システム（NotificationSystem）

![image.png](image%2011.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 通知ドロワー       | Drawer           | 出力  | 画面右からスライドイン。通知一覧を表示                               |
| 通知バッジ         | バッジ           | 出力  | 未読件数を表示（AdminHeaderの通知アイコンに連動）                    |
| 通知リスト         | リスト           | 出力  | 通知内容（提出・承認・変更依頼等）を表示                             |
| 既読マーク         | ボタン           | 入力  | 通知を既読にする                                                     |
| 全削除ボタン       | ボタン           | 入力  | 通知を全て削除                                                       |
| 詳細ダイアログ     | ダイアログ       | 出力  | 通知の詳細内容を表示                                                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 通知ドロワー開閉   | 通知アイコン押下/ドロワークローズ | 通知一覧の表示・非表示 | Drawer表示/非表示   | なし          |
| 通知既読           | ボタン押下時   | 通知を既読にする                      | なし                | なし          |
| 通知全削除         | ボタン押下時   | 通知を全て削除                        | なし                | なし          |
| 通知詳細表示       | 通知クリック時 | 通知の詳細ダイアログを表示            | ダイアログ表示      | なし          |

---

## 2-14. 提出済みスタッフ詳細ダイアログ

![image.png](image%2010.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| スタッフ一覧       | リスト           | 出力  | 提出済み/未提出スタッフの一覧表示                                   |
| スタッフ情報カード | カード           | 出力  | スタッフ名・カナ・役割・提出状況を表示                               |
| 提出状況チップ     | チップ           | 出力  | submitted/draft状態をカラー表示                                      |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログクローズ | ボタン押下時   | スタッフ詳細ダイアログを閉じる        | なし                | なし          |

---

## 2-15. シフト提出ダイアログ

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| ダイアログタイトル | テキスト         | 出力  | 一次店への全スタッフシフト提出確認                                   |
| 提出内容説明       | テキスト         | 出力  | 「20XX年X月の全スタッフのシフト希望を一次店に提出しますか？」        |
| 注意書き           | テキスト         | 出力  | 「※提出後は一次店管理者が承認するまで編集できません。」              |
| 対象スタッフ数     | テキスト         | 出力  | 「対象スタッフ数: XX名」                                             |
| 提出先             | テキスト         | 出力  | 「提出先: 一次店管理システム」                                       |
| キャンセルボタン   | ボタン           | 入力  | ダイアログを閉じる                                                   |
| 提出ボタン         | ボタン           | 入力  | 全スタッフシフトを提出する                                           |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| ダイアログ表示     | 提出ボタン押下時| シフト提出確認ダイアログを表示       | ダイアログ表示      | なし          |
| キャンセル         | ボタン押下時   | ダイアログを閉じる                   | ダイアログ非表示    | なし          |
| シフト提出         | ボタン押下時   | 全スタッフシフトを一次店に提出       | 提出処理実行        | データ存在チェック |

---

## 2-16. Excel出力ダイアログ

![image.png](image%208.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| 対象月選択         | マルチセレクト   | 入力  | エクスポート対象月の複数選択                                         |
| 選択月チップ表示   | チップ           | 出力  | 選択された月をチップで表示                                           |
| エクスポートボタン | ボタン           | 入力  | Excel形式でダウンロード実行                                         |
| プログレス表示     | ローディング     | 出力  | エクスポート中の進行状況表示                                         |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| 対象月選択         | セレクト変更時 | エクスポート対象月の設定             | なし                | なし          |
| Excel出力実行      | ボタン押下時   | Excel形式でのファイル出力            | ダウンロード        | 対象月選択チェック |

---

## 2-17. バックアップ・復元機能

![image.png](image%209.png)

### UI 要素・コントロール・I/O

| 要素名             | コントロール種類 | I/O   | 説明                                                                 |
|--------------------|------------------|-------|----------------------------------------------------------------------|
| バックアップ作成ボタン | ボタン         | 入力  | 現在のデータをLocalStorageにバックアップ                             |
| バックアップ復元ボタン | ボタン         | 入力  | バックアップからデータを復元                                         |
| バックアップクリアボタン | ボタン       | 入力  | バックアップデータを削除                                             |
| バックアップ情報表示 | 情報表示       | 出力  | バックアップの作成日時等を表示                                       |

### イベント定義

| イベント名         | 発生タイミング | イベント概要                         | 遷移先/動作         | バリデーション |
|--------------------|---------------|--------------------------------------|---------------------|---------------|
| バックアップ作成   | ボタン押下時   | データのLocalStorageへの保存          | なし                | なし          |
| バックアップ復元   | ボタン押下時   | バックアップからの復元                | なし                | バックアップ存在チェック |
| バックアップ削除   | ボタン押下時   | バックアップデータの削除              | なし                | 確認ダイアログ |

---

# 3. その他仕様（要素に収まらない共通ルールや制約）

## 編集フロー管理
- **提出前編集**: セルクリック→即座にステータス更新（リアルタイム反映）
- **提出後編集**: 変更依頼ボタン→編集モード開始→一時データ作成→差分検出→変更依頼提出
- **編集状態管理**: `isInEditMode`、`tempShifts`、`tempRequests`で一時データ管理
- **変更検出**: 元データ（`backupShifts`）と一時データの差分を自動計算

## データ管理
- **LocalStorage管理**: シフトデータ、スタッフ要望、バックアップデータ、変更依頼履歴の永続化
- **変更依頼履歴**: `tier2dealer_change_requests` キーでLocalStorageに保存
- **シフト履歴**: セルレベルでの変更履歴を記録（ユーザー名・タイムスタンプ付き）
- **リアルタイム計算**: 案件数・稼働可能人数・未決数の自動計算

## UI/UX仕様
- **固定表示**: 日付列・固定情報行・実績行はstickyで画面に固定
- **アコーディオン表示**: クローザー関連列の展開・折りたたみ機能
- **レスポンシブ対応**: lg/md/sm対応、画面幅に応じて列幅・フォントサイズを調整
- **ダブルクリック機能**: ○セルのハイライト切り替え（`disableDoubleClick`で制御可能）
- **読み取り専用モード**: `isReadOnly`プロパティでセル編集を無効化

## セル種類とカラー設計
- **StatusCell**: ○×△選択、変更履歴ツールチップ、ダブルクリックハイライト
- **LocationCell**: 場所選択（○の場合のみ）
- **RateCell**: 単価入力
- **RequestCell**: 要望入力
- **カラー設計**: クローザー列（青系）、ガール列（ピンク系）、案件数列（青系）、稼働可能列（緑系）、未決列（黄系）、実績行（ピンク系）、土日（オレンジ系）、ヘッダー（グレー系）

## 変更依頼システム
- **フロー**: 提出済み→変更依頼ボタン→編集モード→変更理由入力→確認ダイアログ→提出
- **差分検出**: シフトステータス、要望テキスト、平日希望数、土日希望数の変更を自動検出
- **承認管理**: pending（承認待ち）/approved（承認済み）/rejected（却下）状態管理
- **通知連携**: 変更依頼提出時に一次店管理者に通知送信

## 技術仕様
- **状態管理**: useShiftStore（Zustand）、useState、useMemo、useCallback
- **UI**: Material-UI、TypeScript
- **データ出力**: XLSX、file-saver
- **日付処理**: date-fns
- **認証**: LocalStorageベースの認証状態管理
- **パフォーマンス**: useMemo、useCallbackでの最適化、Container maxWidth={false}で全幅対応 