---

# 1. 画面名

---

**シフト希望入力画面（スタッフ用）**

![image.png](image.png)

---

# 2. 要素別仕様

---

## 2-1. スタッフヘッダー・ナビゲーション

![image.png](image%201.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                                 |
|----------------|------------------|-----|--------------------------------------|
| スタッフ名表示 | テキスト表示     | 出力| ログイン中のスタッフ名を表示（常時表示。スマホ・タブレットでも省略表示で表示される） |
| 年月セレクタ   | セレクトボックス | 入力| 入力対象の年月を選択                 |
| ダッシュボード | ボタン           | 入力| ダッシュボード画面へ遷移             |
| 確認画面       | ボタン           | 入力| 提出状況確認画面へ遷移               |
| ログアウトボタン| アイコンボタン   | 入力| ログアウト処理（押下時に確認ダイアログ表示。「このアカウントからログアウトしますか？」と中央揃え・横幅いっぱいのダイアログで確認。キャンセル・ログアウトの2ボタンも中央揃え） |

### イベント定義

| イベント名         | 発生タイミング | イベント概要               | 遷移先 | バリデーション |
|--------------------|---------------|----------------------------|--------|----------------|
| 年月変更           | 選択時         | 表示データの更新           | なし   | なし           |
| ダッシュボード遷移 | クリック時     | ダッシュボード画面へ遷移   | /staff/dashboard | なし |
| 確認画面遷移       | クリック時     | 提出状況確認画面へ遷移     | /staff/check | なし |
| ログアウト実行     | クリック時     | ログアウト確認ダイアログ表示→OK時にLocalStorage削除・ログアウト | /staff/login | なし |

---

## 2-2. 選択モード・操作パネル

![image.png](image%202.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                                 |
|----------------|------------------|-----|--------------------------------------|
| 選択モードボタン| ボタングループ   | 入力| ○×-の選択モードを切替               |
| ○ボタン        | トグルボタン     | 入力| 稼働希望モードに切替                 |
| ×ボタン        | トグルボタン     | 入力| 稼働不可モードに切替                 |
| -ボタン        | トグルボタン     | 入力| 未定モードに切替                     |
| 提出状況表示   | ステータス表示   | 出力| 提出済み/未提出の状態を表示          |
| 完了状況表示   | プログレス表示   | 出力| 全日入力完了の進捗を表示             |

### イベント定義

| イベント名         | 発生タイミング | イベント概要               | 遷移先 | バリデーション |
|--------------------|---------------|----------------------------|--------|----------------|
| 選択モード変更     | ボタン選択時   | 入力モードの切替           | なし   | なし           |
| 完了状況更新       | 入力時         | 入力完了状況の再計算       | なし   | なし           |

---

## 2-3. カレンダー入力（月曜始まり）

![image.png](image%203.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                                 |
|----------------|------------------|-----|--------------------------------------|
| カレンダーグリッド| グリッド         | 入力| 月曜始まりのカレンダー表示           |
| 曜日ヘッダー   | ヘッダー行       | 出力| 月火水木金土日の曜日表示             |
| 日付セル       | セル             | 入力| クリックで○×-をトグル                |
| ステータス表示 | アイコン/色      | 出力| 各日の選択状態を色分け表示           |
| 土日背景       | 背景色           | 出力| 土日セルの背景色を変更               |
| 前月日付       | 非活性セル       | 出力| 前月の日付を薄く表示                 |
| 次月日付       | 非活性セル       | 出力| 次月の日付を薄く表示                 |

### イベント定義

| イベント名         | 発生タイミング | イベント概要               | 遷移先 | バリデーション |
|--------------------|---------------|----------------------------|--------|----------------|
| 希望日選択         | セル押下時     | 選択モードに応じてステータス設定| なし   | なし           |
| カレンダー生成     | 年月変更時     | カレンダーの再描画         | なし   | なし           |

---

## 2-4. 要望・コメント入力

![image.png](image%204.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                                 |
|----------------|------------------|-----|--------------------------------------|
| 要望入力欄     | テキストエリア   | 入力| シフトに関する要望・コメントを入力   |
| 文字数カウンター| カウンター表示   | 出力| 入力文字数の表示                     |
| 入力ガイド     | ヘルプテキスト   | 出力| 入力例・注意事項の表示               |

### イベント定義

| イベント名         | 発生タイミング | イベント概要               | 遷移先 | バリデーション |
|--------------------|---------------|----------------------------|--------|----------------|
| 要望入力           | 入力時         | コメント内容の自動保存     | なし   | 文字数上限     |
| 文字数更新         | 入力時         | 文字数カウンターの更新     | なし   | なし           |

---

## 2-5. 提出・保存機能

![image.png](image%205.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                                 |
|----------------|------------------|-----|--------------------------------------|
| 提出ボタン     | ボタン           | 入力| 入力内容を正式提出                   |
| 下書き保存ボタン| ボタン           | 入力| 入力内容を下書きとして保存           |
| 提出確認ダイアログ| ダイアログ     | 入出力| 提出前の最終確認                     |
| 成功メッセージ | アラート         | 出力| 提出・保存成功時のメッセージ（コメント欄と提出ボタンの間に表示）         |
| エラーメッセージ| アラート         | 出力| エラー発生時のメッセージ             |

### イベント定義

| イベント名         | 発生タイミング | イベント概要               | 遷移先 | バリデーション |
|--------------------|---------------|----------------------------|--------|----------------|
| シフト提出         | 提出ボタン押下 | 入力内容を正式提出         | なし   | 全日入力チェック|
| 下書き保存         | 保存ボタン押下 | 入力内容を下書き保存       | なし   | なし           |
| 提出確認           | 確認ダイアログ | 最終確認処理               | なし   | なし           |

---

## 2-6. データ管理・同期システム

![image.png](image%206.png)

### UI 要素・コントロール・I/O

| 要素名         | コントロール種類 | I/O | 説明                                 |
|----------------|------------------|-----|--------------------------------------|
| グローバルストア連携| システム処理   | 処理| Zustandストアとの連携                |
| LocalStorage管理| システム処理     | 処理| ローカルストレージでの永続化         |
| 認証状態管理   | システム処理     | 処理| スタッフ認証状態の管理               |
| 提出状況管理   | システム処理     | 処理| 提出済み/未提出状態の管理            |

### イベント定義

| イベント名         | 発生タイミング | イベント概要               | 遷移先 | バリデーション |
|--------------------|---------------|----------------------------|--------|----------------|
| データ読み込み     | 画面表示時     | 保存済みデータの読み込み   | なし   | なし           |
| データ同期         | 入力時         | グローバルストアとの同期   | なし   | なし           |
| 認証確認           | 画面表示時     | ログイン状態の確認         | /staff/login | 認証必須 |

---

# 3. その他仕様（要素に収まらない共通ルールや制約）

- **認証管理**: スタッフログイン必須、セッション管理、自動ログイン設定
- **カレンダー仕様**: 
  - 月曜始まり（月火水木金土日）
  - 土日の背景色変更（薄いオレンジ系）
  - 前月・次月の日付は薄く表示
  - 7日×最大6週の表示
- **ステータス管理**: 
  - ○（稼働希望）: 緑系背景、CheckCircleアイコン
  - ×（稼働不可）: 赤系背景、Cancelアイコン
  - -（未定）: グレー系背景、Removeアイコン
- **選択モード**: 
  - アクティブなモードボタンはハイライト表示
  - セルクリック時は選択中のモードで設定
  - モード切替は即座に反映
- **入力完了チェック**: 
  - 全日（月の全日数）が入力されているかチェック
  - 未入力日がある場合は提出ボタンを非活性化
  - プログレスバーで完了率を表示
- **データ永続化**: 
  - LocalStorageによる自動保存
  - Zustandグローバルストアとの連携
  - 提出状況の永続化
- **レスポンシブ対応**: 
  - デスクトップ: 7列カレンダー表示
  - タブレット: 7列カレンダー（縮小版）
  - スマホ: 縦スクロール対応、タッチ操作最適化
- **アクセシビリティ**: 
  - WCAG 2.2 AA 準拠
  - キーボード操作完全対応（矢印キー、Enter、Space）
  - コントラスト4.5:1以上
  - スクリーンリーダー対応
  - フォーカス表示の明確化
- **UI/UX**: 
  - セルのホバー効果・アニメーション
  - 選択モードボタンのトグル表示
  - ローディング状態表示
  - エラー状態のフォールバック表示
  - 成功・エラーメッセージの自動非表示
- **バリデーション**: 
  - 全日入力必須チェック
  - コメント文字数制限（1000文字）
  - 提出前の最終確認ダイアログ
- **パフォーマンス**: 
  - カレンダー生成の最適化
  - 不要な再レンダリングの防止
  - メモ化による計算コストの削減
- **セキュリティ**: 
  - スタッフ認証必須
  - CSRF対策（将来実装予定）
  - セッションタイムアウト対応
- **デバッグ・開発**: 
  - 開発環境での自動ログイン設定
  - ダミーユーザーデータの使用
  - コンソールログによるデバッグ情報
- **注意事項**: 
  - 現在はダミーデータ・LocalStorageベース
  - 実際のAPI連携は未実装
  - リアルタイム同期機能は未実装
  - 提出後の編集制御は部分実装 